<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lazada URL Parser - ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥ URL Lazada</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #ff6f61;
            text-align: center;
            margin-bottom: 30px;
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            box-sizing: border-box;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #ff6f61;
        }
        button {
            background-color: #ff6f61;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover {
            background-color: #e55a4f;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #ff6f61;
        }
        .result h3 {
            margin-top: 0;
            color: #333;
        }
        .product-id {
            font-size: 18px;
            font-weight: bold;
            color: #ff6f61;
            background-color: #fff3f2;
            padding: 8px 12px;
            border-radius: 4px;
            display: inline-block;
            margin: 5px 0;
        }
        .new-url {
            font-family: monospace;
            background-color: #e9ecef;
            padding: 8px 12px;
            border-radius: 4px;
            word-break: break-all;
            margin: 5px 0;
        }
        
        .new-url a {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .new-url a:hover {
            text-decoration: underline !important;
            opacity: 0.8;
        }
        .error {
            color: #dc3545;
            background-color: #f8d7da;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîó Lazada URL Shortener</h1>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">
            ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡πÅ‡∏•‡∏∞‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå URL ‡∏Ç‡∏≠‡∏á Lazada
        </p>
        
        <div class="input-group">
            <label for="lazadaUrl">URL ‡∏Ç‡∏≠‡∏á Lazada:</label>
            <input type="text" id="lazadaUrl" placeholder="‡∏ß‡∏≤‡∏á URL ‡∏Ç‡∏≠‡∏á Lazada ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." />
        </div>
        
        <div style="text-align: center;">
            <button onclick="shortenUrl()">üîó ‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
            <button onclick="clearResults()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</button>
        </div>
        
        <div id="result" class="result" style="display: none;">
            <h3>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</h3>
            <div id="resultContent"></div>
        </div>
    </div>

    <script>
        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥ URL ‡∏Ç‡∏≠‡∏á Lazada ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
         * @param {string} url - URL ‡∏Ç‡∏≠‡∏á Lazada
         * @returns {string} ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (product ID)
         */
        function extractLazadaProductId(url) {
            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á URL object
                const urlObj = new URL(url);
                
                // ‡∏î‡∏∂‡∏á pathname ‡∏à‡∏≤‡∏Å URL
                const pathname = urlObj.pathname;
                
                // ‡πÉ‡∏ä‡πâ regex ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ pattern ‡∏Ç‡∏≠‡∏á product ID
                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: /products/‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤-i{productId}-s{skuId}.html
                const productIdMatch = pathname.match(/i(\d+)/);
                
                if (productIdMatch) {
                    return productIdMatch[1]; // ‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ç‡∏≠‡∏á product ID
                }
                
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÅ‡∏£‡∏Å ‡∏•‡∏≠‡∏á‡∏´‡∏≤‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô
                // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: /i{productId}.html
                const simpleMatch = pathname.match(/\/i(\d+)\.html/);
                if (simpleMatch) {
                    return simpleMatch[1];
                }
                
                throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô URL');
                
            } catch (error) {
                console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å URL:', error.message);
                return null;
            }
        }

        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
         * @param {string} productId - ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
         * @returns {string} URL ‡πÉ‡∏´‡∏°‡πà
         */
        function createLazadaUrl(productId) {
            return `https://www.lazada.co.th/i${productId}.html`;
        }

        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏õ‡∏•‡∏á URL
         * @param {string} originalUrl - URL ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á Lazada
         * @returns {string} URL ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
         */
        function convertLazadaUrl(originalUrl) {
            const productId = extractLazadaProductId(originalUrl);
            if (productId) {
                return createLazadaUrl(productId);
            }
            return null;
        }



        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
         */
        function showError(message) {
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            
            resultContent.innerHTML = `<div class="error">${message}</div>`;
            resultDiv.style.display = 'block';
        }

        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå Lazada ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ API
         * @param {string} lazadaUrl - URL ‡∏Ç‡∏≠‡∏á Lazada ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠
         * @returns {Promise<Object>} ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå
         */
        async function shortenLazadaUrl(lazadaUrl) {
            try {
                const apiUrl = `https://getlink-lazada.lslly.com/api/v1?link=${encodeURIComponent(lazadaUrl)}`;
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                return {
                    success: data.success,
                    shortenedUrl: data.data?.message || null,
                    originalUrl: data.originalUrl || lazadaUrl,
                    timestamp: data.timestamp,
                    resultCode: data.data?.resultCode,
                    error: null
                };
                
            } catch (error) {
                return {
                    success: false,
                    shortenedUrl: null,
                    originalUrl: lazadaUrl,
                    timestamp: new Date().toISOString(),
                    resultCode: null,
                    error: error.message
                };
            }
        }

        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• URL ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£ (‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥ + ‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå)
         * @param {string} originalUrl - URL ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á Lazada
         * @returns {Promise<Object>} ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•
         */
        async function processLazadaUrl(originalUrl) {
            try {
                // ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥ URL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                const productId = extractLazadaProductId(originalUrl);
                const cleanUrl = productId ? createLazadaUrl(productId) : null;
                
                // ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ clean URL)
                let shortenedResult = null;
                if (cleanUrl) {
                    shortenedResult = await shortenLazadaUrl(cleanUrl);
                }
                
                return {
                    success: true,
                    originalUrl: originalUrl,
                    productId: productId,
                    cleanUrl: cleanUrl,
                    shortenedUrl: shortenedResult?.shortenedUrl || null,
                    timestamp: new Date().toISOString(),
                    error: null
                };
                
            } catch (error) {
                return {
                    success: false,
                    originalUrl: originalUrl,
                    productId: null,
                    cleanUrl: null,
                    shortenedUrl: null,
                    timestamp: new Date().toISOString(),
                    error: error.message
                };
            }
        }

        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå
         */
        async function shortenUrl() {
            const urlInput = document.getElementById('lazadaUrl').value.trim();
            const resultDiv = document.getElementById('result');
            const resultContent = document.getElementById('resultContent');
            
            if (!urlInput) {
                showError('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Lazada');
                return;
            }
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
            resultContent.innerHTML = '<div style="text-align: center; color: #666;">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå...</div>';
            resultDiv.style.display = 'block';
            
            try {
                // ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥ URL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                const productId = extractLazadaProductId(urlInput);
                const cleanUrl = productId ? createLazadaUrl(productId) : null;
                
                // ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå
                const result = await shortenLazadaUrl(cleanUrl || urlInput);
                
                if (result.success && result.shortenedUrl) {
                    resultContent.innerHTML = `
                        <p><strong>‚úÖ ‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</strong></p>
                        
                        <p><strong>üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏î‡∏¥‡∏°:</strong></p>
                        <div class="new-url">
                            <a href="${urlInput}" target="_blank" style="color: #333; text-decoration: none;">
                                ${urlInput}
                            </a>
                        </div>
                        
                        <p><strong>‚úÇÔ∏è ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡πÅ‡∏•‡πâ‡∏ß:</strong></p>
                        <div class="new-url" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
                            ${cleanUrl ? 
                                `<a href="${cleanUrl}" target="_blank" style="color: #856404; text-decoration: none;">${cleanUrl}</a>` : 
                                '<span style="color: #856404;">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡πÑ‡∏î‡πâ</span>'
                            }
                        </div>
                        
                        <p><strong>üîó ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡∏¢‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß:</strong></p>
                        <div class="new-url" style="background-color: #d4edda; border-left: 4px solid #28a745;">
                            <a href="${result.shortenedUrl}" target="_blank" style="color: #155724; text-decoration: none;">
                                ${result.shortenedUrl}
                            </a>
                        </div>
                    `;
                } else {
                    showError(`‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πà‡∏≠‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏î‡πâ: ${result.error || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'}`);
                }
            } catch (error) {
                showError('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            }
        }



        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡πâ‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
         */
        function clearResults() {
            document.getElementById('lazadaUrl').value = '';
            document.getElementById('result').style.display = 'none';
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏î Enter
        document.getElementById('lazadaUrl').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                shortenUrl();
            }
        });
    </script>
</body>
</html> 